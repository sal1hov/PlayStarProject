{% extends 'base.html' %}
{% load group_check %}

{% block title %}Профиль пользователя{% endblock %}

{% block content %}
    <h1>Личный кабинет</h1>

    <!-- Вывод сообщений -->
    {% if messages %}
        <ul>
            {% for message in messages %}
                <li>{{ message }}</li>
            {% endfor %}
        </ul>
    {% endif %}

    <!-- Информация о пользователе -->
    <p>Имя пользователя: {{ user.username }}</p>
    <p>Имя: {{ user.first_name }}</p>
    <p>Фамилия: {{ user.last_name }}</p>
    <p>Номер телефона: {{ user.phone_number }}</p>
    <p>Email: {{ user.email }}</p>

    <!-- Дети -->
    <h2>Дети</h2>
    {% if user.profile.children.all %}
        <ul>
            {% for child in user.profile.children.all %}
                <li>{{ child.name }}, {{ child.age }} лет</li>
            {% endfor %}
        </ul>
    {% else %}
        <p>Дети не добавлены.</p>
    {% endif %}

    <!-- Форма создания нового бронирования -->
    <h2>Создать новое бронирование</h2>
    <form method="post">
        {% csrf_token %}
        <label for="event_name">Название мероприятия:</label><br>
        {{ booking_form.event_name }}<br>

        <label for="event_date">Дата мероприятия:</label><br>
        {{ booking_form.event_date }}<br>

        <label for="status">Статус:</label><br>
        {{ booking_form.status }}<br>

        <button type="submit" name="create_booking">Создать бронирование</button>
    </form>

    <!-- История бронирований -->
    <h2>История бронирований</h2>
    {% if bookings %}
        <ul>
            {% for booking in bookings %}
                <li>
                    {{ booking.event_name }}<br>
                    Дата бронирования: {{ booking.booking_date }}<br>
                    Дата мероприятия: {{ booking.event_date }}<br>
                    Статус: {{ booking.status }}
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>У вас пока нет бронирований.</p>
    {% endif %}

    <!-- Панели управления -->
    {% if user.is_authenticated %}
        {% if user|has_group:'Admin' or user.is_superuser %}
            <p><a href="{% url 'admin_dashboard' %}">Перейти на админ-панель</a></p>
        {% elif user|has_group:'Manager' %}
            <p><a href="{% url 'manager_dashboard' %}">Перейти на панель менеджера</a></p>
        {% elif user|has_group:'Staff' %}
            <p><a href="{% url 'employee_dashboard' %}">Перейти на панель сотрудника</a></p>
        {% endif %}
    {% endif %}

    <!-- Баллы и бонусы -->
    <h2>Баллы и бонусы</h2>
    <p>Как это работает?</p>
    <ul>
        <li>Накапливайте баллы за посещение нашего центра и оплату услуг.</li>
        <li>Баллы будут привязаны к вашему номеру телефона через сервис Эво.Бонус.</li>
        <li>Вы можете использовать баллы для получения скидок на будущие посещения!</li>
        <li><a href="#">Узнать больше</a></li>
    </ul>

    <!-- Часто задаваемые вопросы -->
    <h2>Часто задаваемые вопросы</h2>
    <ul>
        <li><strong>Как забронировать мероприятие?</strong> Вы можете забронировать мероприятие через наш сайт или по телефону.</li>
        <li><strong>Есть ли скидки для многодетных семей?</strong> Да, у нас есть специальные скидки для многодетных семей.</li>
        <li><strong>Как работают баллы и бонусы?</strong>
            <ul>
                <li>Баллы начисляются за каждое посещение и оплату услуг.</li>
                <li>Они привязываются к вашему номеру телефона через сервис Эво.Бонус.</li>
                <li>Вы можете использовать баллы для получения скидок.</li>
                <li><a href="#">Посмотреть все вопросы</a></li>
            </ul>
        </li>
    </ul>
{% endblock %}